"use strict";var _get=function a(b,c,d){null===b&&(b=Function.prototype);var f=Object.getOwnPropertyDescriptor(b,c);if(f===void 0){var g=Object.getPrototypeOf(b);return null===g?void 0:a(g,c,d)}if("value"in f)return f.value;var h=f.get;return void 0===h?void 0:h.call(d)},_createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(){function a(k,l){return"string"==typeof k?"true"==k?k=!0:"false"==k?k=!1:k=l:void 0==k&&(k=l),k}var c=function(){function k(){_classCallCheck(this,k)}return _createClass(k,[{key:"create",value:function(m){var n=this;this.$element.hide(),this.box=$(document.createElement("div")),this.box.addClass("inputdecor-"+m),this.$element.before(this.box),this.button=$(document.createElement("div")),this.button.addClass("button"),this.active&&this.button.addClass("active"),this.box.append(this.button),this.box.append(this.$element),this.button.bind("click",function(){n.toogle()})}},{key:"activate",value:function(){this.button.addClass("active"),this.$element.prop({checked:!0}),this.$element.change(),this.active=!0}},{key:"deactivate",value:function(){this.button.removeClass("active"),this.$element.prop({checked:!1}),this.$element.change(),this.active=!1}},{key:"toogle",value:function(){this.active?this.deactivate():this.activate()}}]),k}(),d=function k(l){_classCallCheck(this,k);var m=l.attr("type")||l[0].tagName.toLowerCase();"ul"==m||"select"==m?this.input=new j(l):"checkbox"==m?this.input=new g(l):"radio"==m?this.input=new h(l):"file"==m&&(this.input=new f(l))},f=function(){function k(l){_classCallCheck(this,k),this.init(l)}return _createClass(k,[{key:"init",value:function(m){this;this.$element=m,this.files=[],this.settings={text:this.$element.attr("data-text")||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043B",multiple:this.$element.attr("data-multiple")||!1,filesCount:this.$element.attr("data-files-count")||!1,maxSize:this.$element.attr("data-max-size")||!1,maxSumSize:this.$element.attr("data-max-sumsize")||!1,drop:this.$element.attr("data-drop")||!1,class:this.$element.attr("data-class")||!1},this.create(this.settings)}},{key:"create",value:function(m){var n=this;this.$element.hide(),m.multiple&&this.$element[0].setAttribute("multiple",""),this.button=$(document.createElement("button")),this.button.addClass("button"),this.button.text(m.text),this.button.click(function(){n.$element.click()});var o=$(document.createElement("div"));o.addClass("inputdecor-file"),m.class&&o.addClass(m.class),this.filesList=$(document.createElement("div")),this.filesList.addClass("files-list"),this.$element.after(o),o.append(this.button),o.append(this.filesList),o.append(this.$element),this.$element.change(function(){n.$element[0].files&&(n.files=n.getFiles(n.$element[0].files),n.showFiles(n.files),n.$element.val(""))})}},{key:"getFiles",value:function(m){for(var n=[],o=0;o<m.length;o++)n.push(m[o]);return n}},{key:"showFiles",value:function(m){var n=this,o=$(document.createElement("ul")),p="",q=0;m.length>n.settings.filesCount?p="\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0444\u0430\u0439\u043B\u043E\u0432 - "+n.settings.filesCount:m.forEach(function(r){if(n.settings.maxSumSize&&(q+=r.size),q&&q>n.settings.maxSumSize)return void(p="\u041F\u0440\u0435\u0432\u044B\u0448\u0435\u043D \u0441\u0443\u043C\u043C\u0430\u0440\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u043E\u0432.\n\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0441\u0443\u043C\u043C\u0430\u0440\u0435\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440 - "+Math.round(n.settings.maxSumSize/1024)+"kb");if(n.settings.maxSize&&r.size>n.settings.maxSize)return void(p="\u041F\u0440\u0435\u0432\u044B\u0448\u0435\u043D \u0440\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430 \""+r.name+"\".\n\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440 - "+Math.round(n.settings.maxSize/1024)+"kb");var s=Math.round(r.size/1024),t=r.name;o.append("<li><p>"+t+"</p><span>"+s+"kb</span></li>")}),n.filesList.empty(),p?(alert(p),n.$element.val("")):n.filesList.append(o)}}]),k}(),g=function(k){function l(m){_classCallCheck(this,l);var n=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return n.init(m),_get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"create",n).call(n,"checkbox"),n}return _inherits(l,k),_createClass(l,[{key:"init",value:function(n){var o=this;this.$element=n,this.name=n.attr("name"),this.value=n.val(),this.active=function(){var p=o.$element.prop("checked")||o.$element.attr("checked");return!!p}()}}]),l}(c),h=function(k){function l(m){_classCallCheck(this,l);var n=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this)),o=n;return n.init(m),_get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"create",n).call(n,"radio"),n.button.unbind("click"),n.button.bind("click",function(){o.remove||o.active?o.remove&&o.toogle():o.activate()}),n}return _inherits(l,k),_createClass(l,[{key:"init",value:function(n){var o=this;this.$element=n,this.name=n.attr("name"),this.value=n.val(),this.active=function(){var p=o.$element.prop("checked")||o.$element.attr("checked");return!!p}(),this.remove=a(o.$element.attr("data-remove"),!1),this.radios=$("input[type=radio][name=\""+this.name+"\"]"),this.$element[0].inputdecor=this}},{key:"deactiveOther",value:function(n){this.radios.each(function(){this.inputdecor!==n&&this.inputdecor.deactivate()})}},{key:"activate",value:function(){_get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"activate",this).call(this),this.deactiveOther(this)}}]),l}(c),j=function(){function k(l){_classCallCheck(this,k),this.init(l)}return _createClass(k,[{key:"init",value:function(m){var n=this;this.$element=m,this.name=m.attr("name"),this.value=m.val(),this.speed=parseInt(this.$element.attr("data-speed"))||250,this.rollup=n.$element.attr("data-rollup")||!1,this.unselected=n.$element.attr("data-unselected")||!1,this.unselectedText=n.$element.attr("data-unselected-text")||"\u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u043E",this.maxHeight=100,this.active=!1,this.text=function(){var o;return o=n.$element.find("li.active").length?active.text():n.$element.attr("data-text")||"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430",o}(),this.class=this.$element.attr("data-class")||"",this.create()}},{key:"create",value:function(){var m=this,n=this.$element[0].selectedIndex;this.$element.hide(),this.unselected&&this.$element.prepend("<option "+(!n&&"selected")+">"+this.unselectedText+"</option>"),this.select=$(document.createElement("div")),this.select.addClass("inputdecor-select"),this.class&&this.select.addClass(this.class),this.$element.before(this.select),this.button=$(document.createElement("button")),this.button.addClass("button"),this.button.text(this.text),this.select.append(this.button),this.label=$(document.createElement("span")),this.label.addClass("label"),this.select.append(this.label),this.hidden=$(document.createElement("input")),this.hidden.attr("type","hidden"),this.name&&this.hidden.attr("name",this.name),this.hidden.val(this.value),this.select.append(this.hidden),this.list=$(document.createElement("ul")),this.list.addClass("list");var o=this.$element.find("option"),p="";if(o.length?(o.each(function(){p+="<li>"+this.innerText+"</li>"}),this.select.append(this.$element)):p=this.$element[0].innerHTML,void 0!==n){var q=this.$element[0].options[n];this.hidden.val(q.value),this.button.text(q.text)}this.list.append(p),this.wrapper=$(document.createElement("div")),this.wrapper.addClass("list-wrapper"),this.wrapper.css({overflow:"hidden",position:"absolute",width:"100%"}),this.wrapper.append(this.list),this.select.append(this.wrapper),this.wrapper.ready(function(){m.maxHeight=m.wrapper.outerHeight(),m.wrapper.height(0)}),this.rollup&&(this.rollup=$(document.createElement("span")),this.rollup.addClass("rollup"),this.list.append(this.rollup),this.rollup.click(function(){m.close()})),this.button.click(function(){m.toogle()}),this.list.click(function(r){if("LI"==r.target.tagName){var s=$(r.target);s.text()==m.unselectedText?(m.hidden.val(""),m.button.text(m.text)):(m.hidden.val(s.attr("value")),m.button.text(s.text())),m.close(),m.$element[0].selectedIndex=$(r.target).index(),m.$element.change()}}),document.body.addEventListener("click",function(r){r.target.parentNode!=m.select[0]&&m.close()})}},{key:"open",value:function(m){this.wrapper.animate({height:this.maxHeight},void 0===m?this.speed:m),this.button.addClass("active"),this.label.addClass("active"),this.active=!0}},{key:"close",value:function(m){this.wrapper.animate({height:0},void 0===m?this.speed:m),this.button.removeClass("active"),this.label.removeClass("active"),this.active=!1}},{key:"toogle",value:function(m){this.active?this.close(m):this.open(m)}}]),k}();$.fn.decorate=function(){this.each(function(){this.binder=new d($(this))})},$(document).ready(function(){$(".inputdecor").decorate()})})();