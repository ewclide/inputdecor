"use strict";function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _get=function t(e,i,s){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,i);if(void 0===a){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,i,s)}if("value"in a)return a.value;var l=a.get;if(void 0!==l)return l.call(s)},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();!function(){function t(t,e){return"string"==typeof t?t="true"==t||"false"!=t&&e:void 0==t&&(t=e),t}var e=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"create",value:function(t){var e=this;this.elem.hide(),this.box=$(document.createElement("div")),this.box.addClass("inputdecor-"+t),this.elem.before(this.box),this.button=$(document.createElement("div")),this.button.addClass("button"),this.active&&this.button.addClass("active"),this.box.append(this.button),this.box.append(this.elem),this.button.bind("click",function(){e.toogle()})}},{key:"activate",value:function(){this.button.addClass("active"),this.elem.prop({checked:!0}),this.active=!0}},{key:"deactivate",value:function(){this.button.removeClass("active"),this.elem.prop({checked:!1}),this.active=!1}},{key:"toogle",value:function(){this.active?this.deactivate():this.activate()}}]),t}(),i=function t(e){_classCallCheck(this,t);var i=e.elem.attr("type")||e.elem[0].tagName.toLowerCase();"ul"==i||"select"==i?this.input=new l(e):"checkbox"==i?this.input=new a(e):"radio"==i?this.input=new n(e):"file"==i&&(this.input=new s(e))},s=function(){function t(e){_classCallCheck(this,t),this.init(e)}return _createClass(t,[{key:"init",value:function(t){this.elem=t.elem,this.files=[],this.settings={text:t.text||this.elem.attr("data-text")||"Выберите файл",multiple:t.multiple||this.elem.attr("data-multiple")||!1,filesCount:t.filesCount||this.elem.attr("data-files-count")||!1,maxSize:t.maxSize||this.elem.attr("data-max-size")||!1,maxSumSize:t.maxSumSize||this.elem.attr("data-max-sumsize")||!1,drop:t.drop||this.elem.attr("data-drop")||!1,class:t.class||this.elem.attr("data-class")||!1},this.create(this.settings)}},{key:"create",value:function(t){var e=this;this.elem.hide(),t.multiple&&this.elem[0].setAttribute("multiple",""),this.button=$(document.createElement("button")),this.button.addClass("button"),this.button.text(t.text),this.button.click(function(){e.elem.click()});var i=$(document.createElement("div"));i.addClass("inputdecor-file"),t.class&&i.addClass(t.class),this.filesList=$(document.createElement("div")),this.filesList.addClass("files-list"),this.elem.after(i),i.append(this.button),i.append(this.filesList),i.append(this.elem),this.elem.change(function(t){e.elem[0].files&&(e.files=e.getFiles(e.elem[0].files),e.showFiles(e.files),e.elem.val(""))})}},{key:"getFiles",value:function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}},{key:"showFiles",value:function(t){var e=this,i=$(document.createElement("ul")),s="",a=0;t.length>e.settings.filesCount?s="Максимальное количество файлов - "+e.settings.filesCount:t.forEach(function(t){if(e.settings.maxSumSize&&(a+=t.size),a&&a>e.settings.maxSumSize)s="Превышен суммарный размер файлов.\nМаксимальный суммареый размер - "+Math.round(e.settings.maxSumSize/1024)+"kb";else if(e.settings.maxSize&&t.size>e.settings.maxSize)s='Превышен размер файла "'+t.name+'".\nМаксимальный размер - '+Math.round(e.settings.maxSize/1024)+"kb";else{var n=Math.round(t.size/1024),l=t.name;i.append("<li><p>"+l+"</p><span>"+n+"kb</span></li>")}}),e.filesList.empty(),s?(alert(s),e.elem.val("")):e.filesList.append(i)}}]),t}(),a=function(t){function e(t){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.init(t),_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"create",i).call(i,"checkbox"),i}return _inherits(e,t),_createClass(e,[{key:"init",value:function(t){var e=this;this.elem=t.elem,this.name=t.elem.attr("name"),this.value=t.elem.val(),this.active=!(!e.elem.prop("checked")&&!e.elem.attr("checked"))}}]),e}(e),n=function(e){function i(t){_classCallCheck(this,i);var e=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),s=e;return e.init(t),_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"create",e).call(e,"radio"),e.button.unbind("click"),e.button.bind("click",function(){s.remove||s.active?s.remove&&s.toogle():s.activate()}),e}return _inherits(i,e),_createClass(i,[{key:"init",value:function(e){var i=this;this.elem=e.elem,this.name=e.elem.attr("name"),this.value=e.elem.val(),this.active=!(!i.elem.prop("checked")&&!i.elem.attr("checked")),this.remove=t(e.remove||i.elem.attr("data-remove"),!0),this.radios=$('input[type=radio][name="'+this.name+'"]'),this.elem[0].inputdecor=this}},{key:"deactiveOther",value:function(t){this.radios.each(function(){this.inputdecor!==t&&this.inputdecor.deactivate()})}},{key:"activate",value:function(){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"activate",this).call(this),this.deactiveOther(this)}}]),i}(e),l=function(){function t(e){_classCallCheck(this,t),this.init(e)}return _createClass(t,[{key:"init",value:function(t){var e=this;this.elem=t.elem,this.name=t.elem.attr("name"),this.value=t.elem.val(),this.speed=t.speed||parseInt(this.elem.attr("data-speed"))||250,this.rollup=t.rollup||e.elem.attr("data-rollup")||!1,this.unselected=t.unselected||e.elem.attr("data-unselected")||!1,this.unselectedText=t.unselectedText||e.elem.attr("data-unselected-text")||"Не выбрано",this.maxHeight=100,this.active=!1,this.text=e.elem.find("li.active").length?active.text():t.text||e.elem.attr("data-text")||"Выберите из списка",this.class=t.class||this.elem.attr("data-class")||"",this.create()}},{key:"create",value:function(){var t=this;this.elem.hide(),this.select=$(document.createElement("div")),this.select.addClass("inputdecor-select"),this.class&&this.select.addClass(this.class),this.elem.before(this.select),this.button=$(document.createElement("button")),this.button.addClass("button"),this.button.text(this.text),this.select.append(this.button),this.label=$(document.createElement("span")),this.label.addClass("label"),this.select.append(this.label),this.hidden=$(document.createElement("input")),this.hidden.attr("type","hidden"),this.name&&this.hidden.attr("name",this.name),this.hidden.val(this.value),this.select.append(this.hidden),this.list=$(document.createElement("ul")),this.list.addClass("list");var e=this.elem[0].innerHTML;e=e.replace(/option+/g,"li"),this.unselected&&this.list.append("<li unselected >"+this.unselectedText+"</li>"),this.list.append(e),this.wrapper=$(document.createElement("div")),this.wrapper.addClass("list-wrapper"),this.wrapper.css({overflow:"hidden",position:"absolute",width:"100%"}),this.wrapper.append(this.list),this.select.append(this.wrapper),this.wrapper.ready(function(){t.maxHeight=t.wrapper.outerHeight(),t.wrapper.height(0)}),this.rollup&&(this.rollup=$(document.createElement("span")),this.rollup.addClass("rollup"),this.list.append(this.rollup),this.rollup.click(function(e){t.close()})),this.elem.remove(),this.button.click(function(e){t.toogle()}),this.list.click(function(e){if("LI"==e.target.tagName){var i=$(e.target);i.text()==t.unselectedText?(t.hidden.val(""),t.button.text(t.text)):(t.hidden.val(i.attr("value")),t.button.text(i.text()))}}),document.body.addEventListener("click",function(e){e.target.parentNode!=t.select[0]&&t.close()})}},{key:"open",value:function(t){this.wrapper.animate({height:this.maxHeight},void 0!==t?t:this.speed),this.button.addClass("active"),this.label.addClass("active"),this.active=!0}},{key:"close",value:function(t){this.wrapper.animate({height:0},void 0!==t?t:this.speed),this.button.removeClass("active"),this.label.removeClass("active"),this.active=!1}},{key:"toogle",value:function(t){this.active?this.close(t):this.open(t)}}]),t}();$.fn.decorate=function(t){this.each(function(){t?t.elem=$(this):t={elem:$(this)},this.binder=new i(t)})},$(document).ready(function(){$(".inputdecor").decorate()})}();